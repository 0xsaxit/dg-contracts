
# Master/Child game design implementation
## Phase 1 - setting-up contracts
- A) Choose your *default token* (address, name) -> input parameters for next step
- B) Deploy master (contracts/master-example/MasterParent.sol) - *defaultToken (address), tokenName*
- C) Deploy game (contracts/master-example/Roulette.sol) -> save address for E
- D) Deploy game (contracts/master-example/Slots.sol) -> save address for E
- E) Add games to master by using `masterContract.addGame(_newGameAddress, _newGameName, _maximumBet (Wei))`  

## Phase 2 - allocating funds for each game
- Before allocating funds(tokens) for each game make sure you've added any other additional tokens to the master contract:
using: `masterContract.addToken()` with 2 parameters: _tokenAddress, _tokenName

 - Now that you've added tokens you can allocate any of those for each game by using the `masterContract.addFunds()` function with the following parameters: _gameID, _tokenAmount, _tokenName (_gameID is the index of the game in array (0, 1, 2, etc...))

    *Important: Before executing this function make sure this contract is approved to access your wallet funds*

- You can also allocate funds manually. Simply send tokens to the masterContract address and use the `masterContract.manaulAllocation()` function

- To withdraw funds from the contract use the `masterContract.withdrawCollateral()` function with the _gameID, _amount, and _tokensName parameters. For example: `masterContract.withdrawCollateral(0, 100000000000000, "MANA")`

    *(or simply call withdrawMaxTokenBalance() using the _tokenName to withdraw all of the contract funds)*

## Phase 3 - play games

```javascript
    masterContract.play(_gameID, _userAddress, _landID, _machineID, _betIDs[], _betValues[], _betAmount[], _localhash, _tokenName);
    masterContract.play(0, address, uint256, uint256, uint256[], uint256[], uint256[], bytes32, string); // playing roulette
    masterContract.play(0, 0x641ad78baca220c5bd28b51ce8e0f495e85fe689, 1, 1, [3302], [0], [1000000000000000], localhash, "MANA"); // betting on Even
    masterContract.play(0, 0x641ad78baca220c5bd28b51ce8e0f495e85fe689, 1, 1, [3302, 3306], [0,0], [1000000000000000, 1000000000000000], [1,1], _localhash, "MANA"); // betting on Even and High (>=19)

    masterContract.play(1, 0x641ad78baca220c5bd28b51ce8e0f495e85fe689, 1, 1, [1101], [0], [1000000000000000000], _localhash, "MANA") // playing slots
```

#
#
#
#
#
# roulette
Decentral Games roulette

## Step 1 - deploying logic contract
- deploy RouletteLogicInternal.sol
- write down address of the contract

## Step 2 - deploying game controller parent contract
- deploy RouletteParent.sol with contract address from Step 1 as required input parameter
- add some MANA tokens into deployed RouletteParent contract
- make sure user approved/allowed deployed contract to move MANA tokens on his behalf >
 --- https://ropsten.etherscan.io/address/0x2a8Fd99c19271F4F04B1B7b9c4f7cF264b626eDB#writeContract
 --- 1. approve (_spender (address) of contract deployed in Step 2 /  _value (uint256) - amount willing to bet)

## Step 3 - play / make bets / spin (logic guide)
- to place bets and play you need to call only 1 method play() with following parameters

    --- _players: (address of the players) address array
    --- _landID: (ID of the land in game) integer
    --- _machineID: (ID of the machine in game) integer
    --- _betIDs: (array of bets IDs in the game) integer[]
    --- _betValues: (array of values for each betID if it is single bet / dozen / column, otherwise 0) integer[]
    --- _betAmount: (array of amount for each bet, how much willing to bet in tokens) integer[]
    --- _localhash: (generated by UI/Backend as random as possible)
    --- _tokenID: (ID of token that you want to play with)

- here is betID for slots game:

    --- 1101 - bets on jackpot will need to provide betValue

- here are 9 possible betIDs for roulette game:

    --- 3301 - betSingle (need to provide number in _betValues for the number on which user makes a bet 0-36)
    --- 3302 - betEven  (only requires bet amount, betting on all even numbers)
    --- 3303 - betOdd (only requires bet amount, betting on all odd numbers)
    --- 3304 - betRed (only requires bet amount, betting on red numbers)
    --- 3305 - betBlack (only requires bet amount, betting on black numbers)
    --- 3306 - betHigh (only requires bet amount, betting on 19-36 numbers)
    --- 3307 - betLow (only requires bet amount, betting on 1-18 numbers)
    --- 3308 - betColumn (need to provide number of the column 1-3)
    --- 3309 - betDozen (need to provide number of the dozen 1-3)

## Examples

play:
_gameID: 0
_players: ["0x641AD78BAca220C5BD28b51Ce8e0F495e85Fe689","0xa803c226c8281550454523191375695928DcFE92","0x641AD78BAca220C5BD28b51Ce8e0F495e85Fe689"]
_landID: 1
_machineID: 1
_betIDs: [3302,3303,3301]
_betValues: [0,0,15]
_betAmount: [100,100,100]
_localhash: 0x3e2fc3cfcd038924a024f6742c5e16642a8ac9e4ed85fea6619d388ac29a8616
_tokenName: MANA



```javascript
    RouleteParent.play(_userAddress, _landID, _machineID, _betIDs[], _betValues[], _betAmount[], _localhash);
    RouleteParent.play(address, uint256, uint256, uint256[], uint256[], uint256[], uint256);
    RouleteParent.play(0x641ad78baca220c5bd28b51ce8e0f495e85fe689, 1, 1, [3302], [0], [1000000000000000], [1]); //betting on Even
    RouleteParent.play(0x641ad78baca220c5bd28b51ce8e0f495e85fe689, 1, 1, [3302, 3306], [0,0], [1000000000000000, 1000000000000000], [1,1]); //betting on Even and High (>=19)

    SlotGame.play(0x641ad78baca220c5bd28b51ce8e0f495e85fe689, 1, 1, [1101], [0], [1000000000000000000],

```

for testing:

npm install -g truffle@latest
npm install -g ethereumjs-testrpc@latest
npm install -g ganache-cli@latest

start ganachi

npm run test-master
